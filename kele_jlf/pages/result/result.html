<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="x5-fullscreen" content="true" />
	<meta name="full-screen" content="yes" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="0" />
	<title>可口可乐</title>
	<link rel="stylesheet" href="../../css/plugins/loading.css" />
	<link rel="stylesheet" href="../../css/plugins/weui.min.css" />
	<link rel="stylesheet" href="result.css" />
	<script type="text/javascript" src="../../js/plugins/jquery-2.1.4.min.js"></script>
	<script type="text/javascript" src="../../js/plugins/vue.min.js"></script>
	<script type="text/javascript" src="../../js/plugins/jweixin-1.2.0.js"></script>
	<script type="text/javascript" src="../../js/plugins/md5.min.js"></script>
	<script type="text/javascript" src="../../js/plugins/jsencrypt.min.js"></script>
	<script type="text/javascript" src="../../js/plugins/weui.min.js"></script>
	<script type="text/javascript" src="../../js/zexUtility.js"></script>
	<script type="text/javascript" src="../../js/zexService.js"></script>
	<script type="text/javascript" src="../../js/wxConfig.js"></script>
	<script type="text/javascript" src="../../js/zexApis.js"></script>
</head>


<body id="container" class="page_bg">
	<div id="page_loading" class="page-loading">
		<div class="page-loading-control">
			<div class="rect1"></div>
			<div class="rect2"></div>
			<div class="rect3"></div>
			<div class="rect4"></div>
			<div class="rect5"></div>
		</div>
	</div>


	<div class="page_box">
		<img class="bg_img" v-bind:src="page_info.background_img">
		<div class="next" @click="next()">
			<img :src="page_info.complete_btn_img" alt="" @click="next()" />
		</div>

	</div>


</body>
<script>
	new Vue({
		el: "#container",
		data: function() {
			return {
				loading: false,
				page_info: {
//					background_img: "../../images/resultBg.jpg",
//					complete_btn_img: "../../images/resultButton.png"

				},

			};
		},

		created: function() {
			this.urlParams = JSON.parse(window.sessionStorage.getItem("urlParams")) || {};
			this.getReview();

		},
		methods: {
			getReview() {
				var self = this;
				var reqParams = {
					open_id: this.urlParams.open_id,
					promotion_id: this.urlParams.promotion_id,
					timestamp: zexUtil.getTimestamp(),
					result_type: "ticket_check_notice",
				};

				zexApis.getReview(reqParams).done(function(response) {
				
					if (response.code == '200') {
						//成公关闭loading页面
						setTimeout(function() {
							$('#page_loading').css('display', 'none');
						}, 500);

						self.page_info = response.checkResultMap;


					} else {
						self.alertInfo("提示", "网络不好,请重试", "我知道了", true);
						return;
					}
				}).always(function(status) {
					if (status.statusText == 'timeout') {
						self.alertInfo("提示", "网络不好,请重试", "我知道了", true);
					};
				});


				var reqParams = {
					open_id: this.urlParams.open_id,
					operator_type: 'ticket_check_notice',
					note: this.urlParams.promotion_id,
					source: this.urlParams.scene
				};
				zexApis.promotionLog(reqParams).done(function(response) {});



			},

			next: function() {
				wx.closeWindow();
			},

		}
	});

</script>

</html>
