<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="x5-fullscreen" content="true">
    <meta name="full-screen" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>摇一摇抽奖页</title>
    <!-- <script type="text/javascript" src="../../js1/plugins/jquery-2.1.4.min.js"></script>
    <script type="text/javascript" src="../../js1/plugins/jweixin-1.2.0.js"></script>
    <script type="text/javascript" src="../../js1/plugins/md5.min.js"></script>
    <script type="text/javascript" src="../../js1/plugins/vue.min.js"></script>
    <script type="text/javascript" src="../../js1/plugins/hammer.min.js"></script>
    <script type="text/javascript" src="../../js1/plugins/vue-touch.min.js"></script>
    <script type="text/javascript" src="../../js1/plugins/jsencrypt.min.js"></script>
    <script type="text/javascript" src="../../js1/zexUtility.js"></script>
    <script type="text/javascript" src="../../js1/zexService.js"></script>
    <script type="text/javascript" src="../../js1/wxConfig.js"></script> -->
</head>


<body>

    11111
</body>

</html>
<script>
    function permission() {
        if (typeof(DeviceMotionEvent) !== "undefined" && typeof(DeviceMotionEvent.requestPermission) === "function") {
            DeviceMotionEvent.requestPermission()
                .then(response => {
                    alert(response);
                    if (response == "granted") {
                        window.addEventListener("devicemotion", (e) => {
                            alert(e.acceleration);
                            //do sth.（同样可以在这里进行摇一摇判断，相当于如果是iOS13+,则执行这里）
                            //进入摇一摇判断
                            var acc = e.acceleration;
                            x = acc.x;
                            y = acc.y;
                            if (Math.abs(x - lastX) > speed || Math.abs(y - lastY) > speed) {
                                //触发摇一摇
                                //do sth.
                            }
                            lastX = x;
                            lastY = y;
                        })
                    }
                })
                .catch(
                    alert(error)

                )
        } else {
            alert("DeviceMotionEvent is not defined");
        }
    }




    var speed = 15; //5~25，数字越大灵敏度越低
    var x = y = z = lastX = lastY = lastZ = 0;
    if (window.DeviceOrientationEvent) {
        if (navigator.userAgent.indexOf('MicroMessenger/7.0.12') > -1 && navigator.userAgent.indexOf('iPhone OS 13') > -
            1)
            permission();
        else {
            alert('普通ios或安卓');
            window.addEventListener("devicemotion", (e) => {
                //进入摇一摇判断
                var acc = e.acceleration;
                x = acc.x;
                y = acc.y;
                if (Math.abs(x - lastX) > speed || Math.abs(y - lastY) > speed) {
                    //触发摇一摇
                    //do sth.
                    alert("可以")
                }
                lastX = x;
                lastY = y;
            })
        }
    } else {
        alert('不支持陀螺仪');
    }
</script>